jQuery(function(){if(!("ace"in window)){window.ace={}}window.ace.click_event=$.fn.tap?"tap":"click"});(function(e,t){var n="multiple"in document.createElement("INPUT");var r="FileList"in window;var i="FileReader"in window;var s=function(t,n){var r=this;this.settings=e.extend({},e.fn.ace_file_input.defaults,n);this.$element=e(t);this.element=t;this.disabled=false;this.can_reset=true;this.$element.on("change.ace_inner_call",function(e,t){if(t===true){return}return u.call(r)});this.$element.wrap('<div class="ace-file-input" />');this.apply_settings()};s.error={FILE_LOAD_FAILED:1,IMAGE_LOAD_FAILED:2,THUMBNAIL_FAILED:3};s.prototype.apply_settings=function(){var e=this;var t=!!this.settings.icon_remove;this.multi=this.$element.attr("multiple")&&n;this.well_style=this.settings.style=="well";if(this.well_style){this.$element.parent().addClass("ace-file-multiple")}else{this.$element.parent().removeClass("ace-file-multiple")}this.$element.parent().find(":not(input[type=file])").remove();this.$element.after('<label data-title="'+this.settings.btn_choose+'"><span data-title="'+this.settings.no_file+'">'+(this.settings.no_icon?'<i class="'+this.settings.no_icon+'"></i>':"")+"</span></label>"+(t?'<a class="remove" href="#"></a>':""));this.$label=this.$element.next();this.$label.on("click",function(){if(!this.disabled&&!e.element.disabled&&!e.$element.attr("readonly")){e.$element.click()}});if(t){this.$label.next("a").on(ace.click_event,function(){if(!e.can_reset){return false}var t=true;if(e.settings.before_remove){t=e.settings.before_remove.call(e.element)}if(!t){return false}return e.reset_input()})}if(this.settings.droppable&&r){o.call(this)}};s.prototype.show_file_list=function(t){var n=typeof t==="undefined"?this.$element.data("ace_input_files"):t;if(!n||n.length==0){return}if(this.well_style){this.$label.find("span").remove();if(!this.settings.btn_change){this.$label.addClass("hide-placeholder")}}this.$label.attr("data-title",this.settings.btn_change).addClass("selected");for(var r=0;r<n.length;r++){var s=typeof n[r]==="string"?n[r]:e.trim(n[r].name);var o=s.lastIndexOf("\\")+1;if(o==0){o=s.lastIndexOf("/")+1}s=s.substr(o);var u="icon-file";if(/\.(jpe?g|png|gif|svg|bmp|tiff?)$/i.test(s)){u="icon-picture"}else{if(/\.(mpe?g|flv|mov|avi|swf|mp4|mkv|webm|wmv|3gp)$/i.test(s)){u="icon-film"}else{if(/\.(mp3|ogg|wav|wma|amr|aac)$/i.test(s)){u="icon-music"}}}if(!this.well_style){this.$label.find("span").attr({"data-title":s}).find('[class*="icon-"]').attr("class",u)}else{this.$label.append('<span data-title="'+s+'"><i class="'+u+'"></i></span>');var f=e.trim(n[r].type);var l=i&&this.settings.thumbnail&&(f.length>0&&f.match("image")||f.length==0&&u=="icon-picture");if(l){var c=this;e.when(a.call(this,n[r])).fail(function(e){if(c.settings.preview_error){c.settings.preview_error.call(c,s,e.code)}})}}}return true};s.prototype.reset_input=function(){this.$label.attr({"data-title":this.settings.btn_choose,"class":""}).find("span:first").attr({"data-title":this.settings.no_file,"class":""}).find('[class*="icon-"]').attr("class",this.settings.no_icon).prev("img").remove();if(!this.settings.no_icon){this.$label.find('[class*="icon-"]').remove()}this.$label.find("span").not(":first").remove();if(this.$element.data("ace_input_files")){this.$element.removeData("ace_input_files");this.$element.removeData("ace_input_method")}this.reset_input_field();return false};s.prototype.reset_input_field=function(){this.$element.wrap("<form>").closest("form").get(0).reset();this.$element.unwrap()};s.prototype.enable_reset=function(e){this.can_reset=e};s.prototype.disable=function(){this.disabled=true;this.$element.attr("disabled","disabled").addClass("disabled")};s.prototype.enable=function(){this.disabled=false;this.$element.removeAttr("disabled").removeClass("disabled")};s.prototype.files=function(){return e(this).data("ace_input_files")||null};s.prototype.method=function(){return e(this).data("ace_input_method")||""};s.prototype.update_settings=function(t){this.settings=e.extend({},this.settings,t);this.apply_settings()};var o=function(){var t=this;var n=this.element.parentNode;e(n).on("dragenter",function(e){e.preventDefault();e.stopPropagation()}).on("dragover",function(e){e.preventDefault();e.stopPropagation()}).on("drop",function(e){e.preventDefault();e.stopPropagation();var n=e.originalEvent.dataTransfer;var i=n.files;if(!t.multi&&i.length>1){var s=[];s.push(i[0]);i=s}var o=true;if(t.settings.before_change){o=t.settings.before_change.call(t.element,i,true)}if(!o||o.length==0){return false}if(o instanceof Array||r&&o instanceof FileList){i=o}t.$element.data("ace_input_files",i);t.$element.data("ace_input_method","drop");t.show_file_list(i);t.$element.triggerHandler("change",[true]);return true})};var u=function(){var t=true;if(this.settings.before_change){t=this.settings.before_change.call(this.element,this.element.files||[this.element.value],false)}if(!t||t.length==0){if(!this.$element.data("ace_input_files")){this.reset_input_field()}return false}var n=!r?null:t instanceof Array||t instanceof FileList?t:this.element.files;this.$element.data("ace_input_method","select");if(n&&n.length>0){this.$element.data("ace_input_files",n)}else{var i=e.trim(this.element.value);if(i&&i.length>0){n=[];n.push(i);this.$element.data("ace_input_files",n)}}if(!n||n.length==0){return false}this.show_file_list(n);return true};var a=function(t){var n=this;var r=n.$label.find("span:last");var i=new e.Deferred;var o=new FileReader;o.onload=function(o){r.prepend("<img class='middle' style='display:none;' />");var u=r.find("img:last").get(0);e(u).one("load",function(){var o=50;if(n.settings.thumbnail=="large"){o=150}else{if(n.settings.thumbnail=="fit"){o=r.width()}}r.addClass(o>50?"large":"");var a=f(u,o,t.type);if(a==null){e(this).remove();i.reject({code:s.error.THUMBNAIL_FAILED});return}var c=a.w,d=a.h;if(n.settings.thumbnail=="small"){c=d=o}e(u).css({"background-image":"url("+a.src+")",width:c,height:d}).data("thumb",a.src).attr({src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="}).show();i.resolve()}).one("error",function(){r.find("img").remove();i.reject({code:s.error.IMAGE_LOAD_FAILED})});u.src=o.target.result};o.onerror=function(e){i.reject({code:s.error.FILE_LOAD_FAILED})};o.readAsDataURL(t);return i.promise()};var f=function(e,t,n){var r=e.width,i=e.height;if(r>t||i>t){if(r>i){i=parseInt(t/r*i);r=t}else{r=parseInt(t/i*r);i=t}}var s;try{var o=document.createElement("canvas");o.width=r;o.height=i;var u=o.getContext("2d");u.drawImage(e,0,0,e.width,e.height,0,0,r,i);s=o.toDataURL()}catch(a){s=null}if(!/^data\:image\/(png|jpe?g|gif);base64,[0-9A-Za-z\+\/\=]+$/.test(s)){s=null}if(!s){return null}return{src:s,w:r,h:i}};e.fn.ace_file_input=function(n,r){var i;var o=this.each(function(){var t=e(this);var o=t.data("ace_file_input");var u=typeof n==="object"&&n;if(!o){t.data("ace_file_input",o=new s(this,u))}if(typeof n==="string"){i=o[n](r)}});return i===t?o:i};e.fn.ace_file_input.defaults={style:false,no_file:"No File ...",no_icon:"icon-upload-alt",btn_choose:"Choose",btn_change:"Change",icon_remove:"icon-remove",droppable:false,thumbnail:false,before_change:null,before_remove:null,preview_error:null}})(window.jQuery);(function(e,t){e.fn.ace_spinner=function(t){this.each(function(){var n=t.icon_up||"icon-chevron-up";var r=t.icon_down||"icon-chevron-down";var i=t.btn_up_class||"";var s=t.btn_down_class||"";var o=t.max||999;o=(""+o).length;var u=e(this).addClass("spinner-input").css("width",o*10+"px").wrap('<div class="ace-spinner">').after('<div class="spinner-buttons btn-group btn-group-vertical">						<button type="button" class="btn spinner-up btn-mini '+i+'">						<i class="'+n+'"></i>						</button>						<button type="button" class="btn spinner-down btn-mini '+s+'">						<i class="'+r+'"></i>						</button>						</div>').closest(".ace-spinner").spinner(t).wrapInner("<div class='input-append'></div>");e(this).on("mousewheel DOMMouseScroll",function(e){var t=e.originalEvent.detail<0||e.originalEvent.wheelDelta>0?1:-1;u.spinner("step",t>0);u.spinner("triggerChangedEvent");return false});var f=e(this);u.on("changed",function(){f.trigger("change")})});return this}})(window.jQuery);(function(e,t){e.fn.ace_wizard=function(t){this.each(function(){var t=e(this);var n=t.find("li");var r=n.length;var i=parseFloat((100/r).toFixed(1))+"%";n.css({"min-width":i,"max-width":i});t.show().wizard();var s=t.siblings(".wizard-actions").eq(0);var o=t.data("wizard");o.$prevBtn.remove();o.$nextBtn.remove();o.$prevBtn=s.find(".btn-prev").eq(0).on(ace.click_event,function(){t.wizard("previous")}).attr("disabled","disabled");o.$nextBtn=s.find(".btn-next").eq(0).on(ace.click_event,function(){t.wizard("next")}).removeAttr("disabled");o.nextText=o.$nextBtn.text()});return this}})(window.jQuery);(function(e,t){e.fn.ace_colorpicker=function(t){var n=e.extend({pull_right:false,caret:true},t);this.each(function(){var t=e(this);var r="";var i="";e(this).hide().find("option").each(function(){var e="colorpick-btn";if(this.selected){e+=" selected";i=this.value}r+='<li><a class="'+e+'" href="#" style="background-color:'+this.value+';" data-color="'+this.value+'"></a></li>'}).end().on("change.ace_inner_call",function(){e(this).next().find(".btn-colorpicker").css("background-color",this.value)}).after('<div class="dropdown dropdown-colorpicker"><a data-toggle="dropdown" class="dropdown-toggle" href="#"><span class="btn-colorpicker" style="background-color:'+i+'"></span></a><ul class="dropdown-menu'+(n.caret?" dropdown-caret":"")+(n.pull_right?" pull-right":"")+'">'+r+"</ul></div>").next().find(".dropdown-menu").on(ace.click_event,function(n){var r=e(n.target);if(!r.is(".colorpick-btn")){return false}r.closest("ul").find(".selected").removeClass("selected");r.addClass("selected");var i=r.data("color");t.val(i).change();n.preventDefault();return true})});return this}})(window.jQuery);(function(e,t){e.fn.ace_tree=function(t){var n={"open-icon":"icon-folder-open","close-icon":"icon-folder-close",selectable:true,"selected-icon":"icon-ok","unselected-icon":"tree-dot"};n=e.extend({},n,t);this.each(function(){var t=e(this);t.html('<div class = "tree-folder" style="display:none;">				<div class="tree-folder-header">					<i class="'+n["close-icon"]+'"></i>					<div class="tree-folder-name"></div>				</div>				<div class="tree-folder-content"></div>				<div class="tree-loader" style="display:none"></div>			</div>			<div class="tree-item" style="display:none;">				'+(n["unselected-icon"]==null?"":'<i class="'+n["unselected-icon"]+'"></i>')+'				<div class="tree-item-name"></div>			</div>');t.addClass(n.selectable==true?"tree-selectable":"tree-unselectable");t.tree(n)});return this}})(window.jQuery);(function(e,t){e.fn.ace_wysiwyg=function(t,n){var r=e.extend({speech_button:true,wysiwyg:{}},t);var i=["#ac725e","#d06b64","#f83a22","#fa573c","#ff7537","#ffad46","#42d692","#16a765","#7bd148","#b3dc6c","#fbe983","#fad165","#92e1c0","#9fe1e7","#9fc6e7","#4986e7","#9a9cff","#b99aff","#c2c2c2","#cabdbf","#cca6ac","#f691b2","#cd74e6","#a47ae2","#444444"];var s={font:{values:["Arial","Courier","Comic Sans MS","Helvetica","Open Sans","Tahoma","Verdana"],icon:"icon-font",title:"Font"},fontSize:{values:{5:"Huge",3:"Normal",1:"Small"},icon:"icon-text-height",title:"Font Size"},bold:{icon:"icon-bold",title:"Bold (Ctrl/Cmd+B)"},italic:{icon:"icon-italic",title:"Italic (Ctrl/Cmd+I)"},strikethrough:{icon:"icon-strikethrough",title:"Strikethrough"},underline:{icon:"icon-underline",title:"Underline"},insertunorderedlist:{icon:"icon-list-ul",title:"Bullet list"},insertorderedlist:{icon:"icon-list-ol",title:"Number list"},outdent:{icon:"icon-indent-left",title:"Reduce indent (Shift+Tab)"},indent:{icon:"icon-indent-right",title:"Indent (Tab)"},justifyleft:{icon:"icon-align-left",title:"Align Left (Ctrl/Cmd+L)"},justifycenter:{icon:"icon-align-center",title:"Center (Ctrl/Cmd+E)"},justifyright:{icon:"icon-align-right",title:"Align Right (Ctrl/Cmd+R)"},justifyfull:{icon:"icon-align-justify",title:"Justify (Ctrl/Cmd+J)"},createLink:{icon:"icon-link",title:"Hyperlink",button_text:"Add",placeholder:"URL"},unlink:{icon:"icon-unlink",title:"Remove Hyperlink"},insertImage:{icon:"icon-picture",title:"Insert picture",button_text:'<i class="icon-file"></i> Choose Image &hellip;',placeholder:"Image URL"},foreColor:{values:i,title:"Change Color"},backColor:{values:i,title:"Change Background Color"},undo:{icon:"icon-undo",title:"Undo (Ctrl/Cmd+Z)"},redo:{icon:"icon-repeat",title:"Redo (Ctrl/Cmd+Y)"}};var o=r.toolbar||["font",null,"fontSize",null,"bold","italic","strikethrough","underline",null,"insertunorderedlist","insertorderedlist","outdent","indent",null,"justifyleft","justifycenter","justifyright","justifyfull",null,"createLink","unlink",null,"insertImage",null,"foreColor",null,"undo","redo"];this.each(function(){var t=' <div class="wysiwyg-toolbar btn-toolbar center"> <div class="btn-group"> ';for(var n in o){if(o.hasOwnProperty(n)){var i=o[n];if(i===null){t+=' </div> <div class="btn-group"> ';continue}if(typeof i=="string"&&i in s){i=s[i];i.name=o[n]}else{if(typeof i=="object"&&i.name in s){i=e.extend(s[i.name],i)}else{continue}}var u="className"in i?i.className:"";switch(i.name){case"font":t+=' <a class="btn btn-small '+u+' dropdown-toggle" data-toggle="dropdown" title="'+i.title+'"><i class="'+i.icon+'"></i><i class="icon-angle-down icon-on-right"></i></a> ';t+=' <ul class="dropdown-menu dropdown-light">';for(var l in i.values){if(i.values.hasOwnProperty(l)){t+=' <li><a data-edit="fontName '+i.values[l]+'" style="font-family:\''+i.values[l]+"'\">"+i.values[l]+"</a></li> "}}t+=" </ul>";break;case"fontSize":t+=' <a class="btn btn-small '+u+' dropdown-toggle" data-toggle="dropdown" title="'+i.title+'"><i class="'+i.icon+'"></i>&nbsp;<i class="icon-angle-down icon-on-right"></i></a> ';t+=' <ul class="dropdown-menu dropdown-light"> ';for(var c in i.values){if(i.values.hasOwnProperty(c)){t+=' <li><a data-edit="fontSize '+c+'"><font size="'+c+'">'+i.values[c]+"</font></a></li> "}}t+=" </ul> ";break;case"createLink":t+=' <a class="btn btn-small '+u+' dropdown-toggle" data-toggle="dropdown" title="'+i.title+'"><i class="'+i.icon+'"></i></a> ';t+=' <div class="dropdown-menu dropdown-caret input-append pull-right">							<input placeholder="'+i.placeholder+'" type="text" data-edit="'+i.name+'" />							<button class="btn btn-small btn-primary" type="button">'+i.button_text+"</button>						</div> ";break;case"insertImage":t+=' <a class="btn btn-small '+u+' dropdown-toggle" data-toggle="dropdown" title="'+i.title+'"><i class="'+i.icon+'"></i></a> ';t+=' <div class="dropdown-menu dropdown-caret input-append pull-right">							<input placeholder="'+i.placeholder+'" type="text" data-edit="'+i.name+'" />							<button class="btn btn-small btn-primary" type="button">Insert</button> ';if("FileReader"in window){t+='<div class="center">								<button class="btn btn-small btn-success wysiwyg-choose-file" type="button">'+i.button_text+'</button>								<input type="file" data-edit="'+i.name+'" />							  </div>'}t+=" </div> ";break;case"foreColor":case"backColor":t+=' <select class="hide wysiwyg_colorpicker" title="'+i.title+'"> ';for(var h in i.values){t+=' <option value="'+i.values[h]+'">'+i.values[h]+"</option> "}t+=" </select> ";t+=' <input style="display:none;" disabled class="hide" type="text" data-edit="'+i.name+'" /> ';break;default:t+=' <a class="btn btn-small '+u+'" data-edit="'+i.name+'" title="'+i.title+'"><i class="'+i.icon+'"></i></a> ';break}}}t+=" </div> </div> ";if(r.toolbar_place){t=r.toolbar_place.call(this,t)}else{t=e(this).before(t).prev()}t.find("a[title]").tooltip({animation:false});t.find(".dropdown-menu input:not([type=file])").on(ace.click_event,function(){return false}).on("change",function(){e(this).closest(".dropdown-menu").siblings(".dropdown-toggle").dropdown("toggle")}).on("keydown",function(t){if(t.which==27){this.value="";e(this).change()}});t.find("input[type=file]").prev().on(ace.click_event,function(t){e(this).next().click()});t.find(".wysiwyg_colorpicker").each(function(){e(this).ace_colorpicker({pull_right:true,caret:false}).change(function(){e(this).nextAll("input").eq(0).val(this.value).change()}).next().find(".btn-colorpicker").tooltip({title:this.title,animation:false})});var p;if(r.speech_button&&"onwebkitspeechchange"in(p=document.createElement("input"))){var v=e(this).offset();t.append(p);e(p).attr({type:"text","data-edit":"inserttext","x-webkit-speech":""}).addClass("wysiwyg-speech-input").css({position:"absolute"}).offset({top:v.top,left:v.left+e(this).innerWidth()-35})}else{p=null}var m=e.extend({},{activeToolbarClass:"active",toolbarSelector:t},r.wysiwyg||{});e(this).wysiwyg(m)});return this}})(window.jQuery)

